{
  "hash": "01c46c2bee53fd338fa545ea41393ed9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Practice Code\"\nauthor: \"Sydney Stitt\"\ndate: \"Math 241, Week 14\"\noutput:\n  pdf_document\nurlcolor: blue\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Put all necessary libraries here\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(readr)\nlibrary(ggplot2)\nlibrary(sf)\nlibrary(tmap)\nlibrary(shiny)\nlibrary(lubridate)\nlibrary(viridis)\nlibrary(scales)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Pulling data from csv files\ncat_movement <- read_csv(\"data/cats_us.csv\")\ncat_reference <- read_csv(\"data/cats_us_reference.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Tidying up the date and time variables in both dataframes\ncat_movement <- cat_movement %>% \n  mutate(Time = format(as.POSIXct(timestamp), \n                       format = \"%H:%M:%S\"),\n         Date = as.Date(timestamp)) %>%\n  filter(visible) %>%\n  subset(select = -timestamp)\ncat_reference <- cat_reference %>%\n  mutate(`Date-Deploy-On` = as.Date(`deploy-on-date`),\n         `Time-Deploy-On` = format(as.POSIXct(`deploy-on-date`), \n                                   format = \"%H:%M:%S\"),\n         `Date-Deploy-Off` = as.Date(`deploy-off-date`),\n         `Time-Deploy-Off` = format(as.POSIXct(`deploy-off-date`), \n                                    format = \"%H:%M:%S\")) %>%\n  subset(select = -`deploy-off-date`) %>%\n  subset(select = -`deploy-on-date`)\n#ordering data alphabetically by animal id\ncat_reference <- cat_reference[order(cat_reference$`animal-id`), ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Separating the movement dataset by cat\nfilter_individual <- function(data, identifier) {\n  filtered_data <- filter(data, `individual-local-identifier` == identifier)\n  return(filtered_data)\n}\nAjax2 <- filter_individual(cat_movement, \"Ajax2\")\nAnubis <- filter_individual(cat_movement, \"Anubis2\")\nAsher2 <- filter_individual(cat_movement, \"Asher2\")\nAsibo2 <- filter_individual(cat_movement, \"Asibo2\")\nAtticus <- filter_individual(cat_movement, \"Atticus\")\nAya2 <- filter_individual(cat_movement, \"Aya2\")\nBabyKitty <- filter_individual(cat_movement, \"Baby Kitty 2\")\nBanjo2 <- filter_individual(cat_movement, \"Banjo2\")\nBean2 <- filter_individual(cat_movement, \"Bean2\")\nBeatle2 <- filter_individual(cat_movement, \"Beatle2\")\nBela2 <- filter_individual(cat_movement, \"Bela2\")\nBella2 <- filter_individual(cat_movement, \"Bella2\")\nBeluga <- filter_individual(cat_movement, \"Beluga\")\nBenny <- filter_individual(cat_movement, \"Benny\")\nBillyWhiskers <- filter_individual(cat_movement, \"Billy Whiskers2\")\nBongo2 <- filter_individual(cat_movement, \"Bongo2\")\nBooBooKitty <- filter_individual(cat_movement, \"BooBooKitty\")\nBoris2 <- filter_individual(cat_movement, \"Boris2\")\nBumbles2 <- filter_individual(cat_movement, \"Bumbles2\")\nCaptainAmerica <- filter_individual(cat_movement, \"Captain America 2\")\nCatMarshall <- filter_individual(cat_movement, \"Cat Marshall\")\nCatnissEverdeen <- filter_individual(cat_movement, \"Catniss Everdeen\")\nCayden2 <- filter_individual(cat_movement, \"Cayden2\")\nCedar2 <- filter_individual(cat_movement, \"Cedar2\")\nChester2 <- filter_individual(cat_movement, \"Chester2\")\nClimber2 <- filter_individual(cat_movement, \"Climber2\")\nCoal <- filter_individual(cat_movement, \"Coal\")\nConan <- filter_individual(cat_movement, \"Conan\")\nDiamond2 <- filter_individual(cat_movement, \"Diamond2\")\nDonCarlos <- filter_individual(cat_movement, \"Don Carlos2\")\nDonaldFluffypants <- filter_individual(cat_movement, \"Donald Fluffypants\")\nDouglas <- filter_individual(cat_movement, \"Douglas\")\nElle <- filter_individual(cat_movement, \"Elle\")\nEmmy2 <- filter_individual(cat_movement, \"Emmy2\")\nFenimoreCooper <- filter_individual(cat_movement, \"Fenimore Cooper2\")\nFiona2 <- filter_individual(cat_movement, \"Fiona2\")\nFletcher2 <- filter_individual(cat_movement, \"Fletcher2\")\nFrank <- filter_individual(cat_movement, \"Frank\")\nFranklin <- filter_individual(cat_movement, \"Franklin\")\nGeorge2 <- filter_individual(cat_movement, \"George2\")\nGianni2 <- filter_individual(cat_movement, \"Gianni2\")\nGoliath2 <- filter_individual(cat_movement, \"Goliath2\")\nGracie <- filter_individual(cat_movement, \"Gracie\")\nGracieL2 <- filter_individual(cat_movement, \"Gracie L2\")\nHailey2 <- filter_individual(cat_movement, \"Hailey2\")\nHarley2 <- filter_individual(cat_movement, \"Harley2\")\nHemingway <- filter_individual(cat_movement, \"Hemingway\")\nHerman2 <- filter_individual(cat_movement, \"Herman2\")\nHershey <- filter_individual(cat_movement, \"Hershey\")\nJack2 <- filter_individual(cat_movement, \"Jack2\")\nJams2 <- filter_individual(cat_movement, \"Jams2\")\nJello2 <- filter_individual(cat_movement, \"Jello2\")\nJetpack <- filter_individual(cat_movement, \"Jetpack\")\nJingles2 <- filter_individual(cat_movement, \"Jingles2\")\nJitterbug2 <- filter_individual(cat_movement, \"Jitterbug2\")\nJoey <- filter_individual(cat_movement, \"Joey\")\nJunior2 <- filter_individual(cat_movement, \"Junior2\")\nJustice <- filter_individual(cat_movement, \"Justice\")\nKagin2 <- filter_individual(cat_movement, \"Kagin2\")\nKatnissEverdeen <- filter_individual(cat_movement, \"Katniss Everdeen\")\nLacey <- filter_individual(cat_movement, \"Lacey\")\nLadybird2 <- filter_individual(cat_movement, \"Ladybird2\")\nLeopard2 <- filter_individual(cat_movement, \"Leopard2\")\nLester <- filter_individual(cat_movement, \"Lester\")\nLittle2 <- filter_individual(cat_movement, \"Little2\")\nLouieTag <- filter_individual(cat_movement, \"LouieTag\")\nLucky2 <- filter_individual(cat_movement, \"Lucky2\")\nLuna2 <- filter_individual(cat_movement, \"Luna2\")\nLupe2 <- filter_individual(cat_movement, \"Lupe2\")\nMaddie2 <- filter_individual(cat_movement, \"Maddie2\")\nMaisey2 <- filter_individual(cat_movement, \"Maisey2\")\nMarco2 <- filter_individual(cat_movement, \"Marco2\")\nMarthaWayne2 <- filter_individual(cat_movement, \"Martha Wayne2\")\nMerrie2 <- filter_individual(cat_movement, \"Merrie2\")\nMia2 <- filter_individual(cat_movement, \"Mia2\")\nMilo <- filter_individual(cat_movement, \"Milo\")\nMindy2 <- filter_individual(cat_movement, \"Mindy2\")\nMinnieH <- filter_individual(cat_movement, \"Minnie H\")\nMisty <- filter_individual(cat_movement, \"Misty\")\nMisu2 <- filter_individual(cat_movement, \"Misu2\")\nMotorcat <- filter_individual(cat_movement, \"Motorcat\")\nMrLucky <- filter_individual(cat_movement, \"Mr.Lucky\")\nNatasha2 <- filter_individual(cat_movement, \"Natasha2\")\nNattyBumpo2 <- filter_individual(cat_movement, \"NattyBumpo2\")\nNia <- filter_individual(cat_movement, \"Nia\")\nNikki2 <- filter_individual(cat_movement, \"Nikki2\")\nNola2Tag <- filter_individual(cat_movement, \"Nola2Tag\")\nOatmeal <- filter_individual(cat_movement, \"Oatmeal\")\nOliver2 <- filter_individual(cat_movement, \"Oliver2\")\nOrange <- filter_individual(cat_movement, \"Orange\")\nOreo2 <- filter_individual(cat_movement, \"Oreo2\")\nOscarJ <- filter_individual(cat_movement, \"Oscar J\")\nOscarL <- filter_individual(cat_movement, \"Oscar L\")\nOscarN <- filter_individual(cat_movement, \"OscarN\")\nParker <- filter_individual(cat_movement, \"Parker\")\nPeanut <- filter_individual(cat_movement, \"Peanut\")\nPeanutR <- filter_individual(cat_movement, \"PeanutR\")\nPenelope2 <- filter_individual(cat_movement, \"Penelope2\")\nPicchu <- filter_individual(cat_movement, \"Picchu\")\nPickles2 <- filter_individual(cat_movement, \"Pickles2\")\nPiper2 <- filter_individual(cat_movement, \"Piper2\")\nPoly <- filter_individual(cat_movement, \"Poly\")\nPringle <- filter_individual(cat_movement, \"Pringle\")\nPsychoKitty <- filter_individual(cat_movement, \"Psycho Kitty2\")\nPumpkinKane <- filter_individual(cat_movement, \"Pumpkin Kane\")\nPumpkin2 <- filter_individual(cat_movement, \"Pumpkin2\")\nPurrcy2 <- filter_individual(cat_movement, \"Purrcy2\")\nReggie2 <- filter_individual(cat_movement, \"Reggie2\")\nRocky <- filter_individual(cat_movement, \"Motorcat\")\nRoukus2 <- filter_individual(cat_movement, \"Roukus2\")\nRussel2 <- filter_individual(cat_movement, \"Russel2\")\nSandstorm2 <- filter_individual(cat_movement, \"Sandstorm2\")\nSasquatch2 <- filter_individual(cat_movement, \"Sasquatch2\")\nSchubie2 <- filter_individual(cat_movement, \"Schubie2\")\nSelkie2 <- filter_individual(cat_movement, \"Selkie2\")\nSenor2 <- filter_individual(cat_movement, \"Senor2\")\nSeth2 <- filter_individual(cat_movement, \"Seth2\")\nShadow2 <- filter_individual(cat_movement, \"Shadow2\")\nShakespeare2 <- filter_individual(cat_movement, \"Shakespeare2\")\nSheldon <- filter_individual(cat_movement, \"Sheldon\")\nSmattie <- filter_individual(cat_movement, \"Smattie\")\nSmokey2 <- filter_individual(cat_movement, \"Smokey2\")\nSnickerdoodle2 <- filter_individual(cat_movement, \"Snickerdoodle2\")\nSolo2 <- filter_individual(cat_movement, \"Solo2\")\nSparkles <- filter_individual(cat_movement, \"Sparkles\")\nSpencer2 <- filter_individual(cat_movement, \"Spencer2\")\nSpike <- filter_individual(cat_movement, \"Spike\")\nStarbuck2 <- filter_individual(cat_movement, \"Starbuck2\")\nStriper2 <- filter_individual(cat_movement, \"Striper2\")\nSunny2 <- filter_individual(cat_movement, \"Sunny2\")\nSurvivor2 <- filter_individual(cat_movement, \"Survivor2\")\nSweetpea <- filter_individual(cat_movement, \"Sweetpea\")\nSylvester <- filter_individual(cat_movement, \"Sylvester\")\nTabasco <- filter_individual(cat_movement, \"Tabasco\")\nTallulah2 <- filter_individual(cat_movement, \"Tallulah2\")\nTara2 <- filter_individual(cat_movement, \"Tara2\")\nTex2 <- filter_individual(cat_movement, \"Tex2\")\nTiger2 <- filter_individual(cat_movement, \"Tiger2\")\nTonka2 <- filter_individual(cat_movement, \"Tonka2\")\nTurtle2 <- filter_individual(cat_movement, \"Turtle2\")\nVioletMae2 <- filter_individual(cat_movement, \"Violet Mae2\")\nWilly2 <- filter_individual(cat_movement, \"Willy2\")\nZelda2 <- filter_individual(cat_movement, \"Zelda2\")\nZiggy <- filter_individual(cat_movement, \"Motorcat\")\nZoey <- filter_individual(cat_movement, \"Zoey\")\nZorro2 <- filter_individual(cat_movement, \"Zorro2\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Custom distance function using Haversine formula to convert coordinates to distance\nhaversine_distance <- function(lon1, lat1, lon2, lat2) {\n  lon1_rad <- lon1 * pi / 180\n  lat1_rad <- lat1 * pi / 180\n  lon2_rad <- lon2 * pi / 180\n  lat2_rad <- lat2 * pi / 180\n  # Earth radius in kilometers\n  R <- 6371\n  # Haversine formula\n  dlon <- lon2_rad - lon1_rad\n  dlat <- lat2_rad - lat1_rad\n  a <- sin(dlat/2)^2 + cos(lat1_rad) * cos(lat2_rad) * sin(dlon/2)^2\n  c <- 2 * atan2(sqrt(a), sqrt(1-a))\n  distance <- R * c\n  return(distance)\n}\n\n# Function to calculate distances and convert to meters\ncalculate_distances <- function(data) {\n  distance <- haversine_distance(data$`location-long`[-nrow(data)], data$`location-lat`[-nrow(data)], \n                                  data$`location-long`[-1], data$`location-lat`[-1])\n  distance <- c(NA, distance)  # Add NA to match the size of the original data frame\n  data <- mutate(data, distance = distance)\n  return(data)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Applying the function to your data frame\nAjax2 <- calculate_distances(Ajax2)\nAnubis <- calculate_distances(Anubis)\nAsher2 <- calculate_distances(Asher2)\nAsibo2 <- calculate_distances(Asibo2)\nAtticus <- calculate_distances(Atticus)\nAya2 <- calculate_distances(Aya2)\nBabyKitty <- calculate_distances(BabyKitty)\nBean2 <- calculate_distances(Bean2)\nBeatle2 <- calculate_distances(Beatle2)\nBela2 <- calculate_distances(Bela2)\nBella2 <- calculate_distances(Bella2)\nBeluga <- calculate_distances(Beluga)\nBenny <- calculate_distances(Benny)\nBillyWhiskers <- calculate_distances(BillyWhiskers)\nBongo2 <- calculate_distances(Bongo2)\nBooBooKitty <- calculate_distances(BooBooKitty)\nBumbles2 <- calculate_distances(Bumbles2)\nCaptainAmerica <- calculate_distances(CaptainAmerica)\nCatMarshall <- calculate_distances(CatMarshall)\nCatnissEverdeen <- calculate_distances(CatnissEverdeen)\nCayden2 <- calculate_distances(Cayden2)\nCedar2 <- calculate_distances(Cedar2)\nChester2 <- calculate_distances(Chester2)\nClimber2 <- calculate_distances(Climber2)\nCoal <- calculate_distances(Coal)\nConan <- calculate_distances(Conan)\nDiamond2 <- calculate_distances(Diamond2)\nDonCarlos <- calculate_distances(DonCarlos)\nDonaldFluffypants <- calculate_distances(DonaldFluffypants)\nDouglas <- calculate_distances(Douglas)\nElle <- calculate_distances(Elle)\nEmmy2 <- calculate_distances(Emmy2)\nFenimoreCooper <- calculate_distances(FenimoreCooper)\nFiona2 <- calculate_distances(Fiona2)\nFletcher2 <- calculate_distances(Fletcher2)\nFrank <- calculate_distances(Frank)\nFranklin <- calculate_distances(Franklin)\nGeorge2 <- calculate_distances(George2)\nGianni2 <- calculate_distances(Gianni2)\nGoliath2 <- calculate_distances(Goliath2)\nGracie <- calculate_distances(Gracie)\nGracieL2 <- calculate_distances(GracieL2)\nHailey2 <- calculate_distances(Hailey2)\nHarley2 <- calculate_distances(Harley2)\nHemingway <- calculate_distances(Hemingway)\nHerman2 <- calculate_distances(Herman2)\nHershey <- calculate_distances(Hershey)\nJack2 <- calculate_distances(Jack2)\nJams2 <- calculate_distances(Jams2)\nJello2 <- calculate_distances(Jello2)\nJetpack <- calculate_distances(Jetpack)\nJingles2 <- calculate_distances(Jingles2)\nJitterbug2 <- calculate_distances(Jitterbug2)\nJoey <- calculate_distances(Joey)\nJunior2 <- calculate_distances(Junior2)\nJustice <- calculate_distances(Justice)\nKagin2 <- calculate_distances(Kagin2)\nKatnissEverdeen <- calculate_distances(KatnissEverdeen)\nLacey <- calculate_distances(Lacey)\nLadybird2 <- calculate_distances(Ladybird2)\nLeopard2 <- calculate_distances(Leopard2)\nLester <- calculate_distances(Lester)\nLittle2 <- calculate_distances(Little2)\nLouieTag <- calculate_distances(LouieTag)\nLucky2 <- calculate_distances(Lucky2)\nLuna2 <- calculate_distances(Luna2)\nLupe2 <- calculate_distances(Lupe2)\nMaddie2 <- calculate_distances(Maddie2)\nMaisey2 <- calculate_distances(Maisey2)\nMarco2 <- calculate_distances(Marco2)\nMarthaWayne2 <- calculate_distances(MarthaWayne2)\nMerrie2 <- calculate_distances(Merrie2)\nMia2 <- calculate_distances(Mia2)\nMilo <- calculate_distances(Milo)\nMindy2 <- calculate_distances(Mindy2)\nMinnieH <- calculate_distances(MinnieH)\nMisty <- calculate_distances(Misty)\nMisu2 <- calculate_distances(Misu2)\nMotorcat <- calculate_distances(Motorcat)\nMrLucky <- calculate_distances(MrLucky)\nNatasha2 <- calculate_distances(Natasha2)\nNattyBumpo2 <- calculate_distances(NattyBumpo2)\nNia <- calculate_distances(Nia)\nNikki2 <- calculate_distances(Nikki2)\nNola2Tag <- calculate_distances(Nola2Tag)\nOatmeal <- calculate_distances(Oatmeal)\nOliver2 <- calculate_distances(Oliver2)\nOrange <- calculate_distances(Orange)\nOreo2 <- calculate_distances(Oreo2)\nOscarJ <- calculate_distances(OscarJ)\nOscarL <- calculate_distances(OscarL)\nOscarN <- calculate_distances(OscarN)\nParker <- calculate_distances(Parker)\nPeanut <- calculate_distances(Peanut)\nPeanutR <- calculate_distances(PeanutR)\nPenelope2 <- calculate_distances(Penelope2)\nPicchu <- calculate_distances(Picchu)\nPickles2 <- calculate_distances(Pickles2)\nPiper2 <- calculate_distances(Piper2)\nPoly <- calculate_distances(Poly)\nPringle <- calculate_distances(Pringle)\nPsychoKitty <- calculate_distances(PsychoKitty)\nPumpkinKane <- calculate_distances(PumpkinKane)\nPumpkin2 <- calculate_distances(Pumpkin2)\nPurrcy2 <- calculate_distances(Purrcy2)\nReggie2 <- calculate_distances(Reggie2)\nRocky <- calculate_distances(Rocky)\nRoukus2 <- calculate_distances(Roukus2)\nRussel2 <- calculate_distances(Russel2)\nSandstorm2 <- calculate_distances(Sandstorm2)\nSasquatch2 <- calculate_distances(Sasquatch2)\nSchubie2 <- calculate_distances(Schubie2)\nSelkie2 <- calculate_distances(Selkie2)\nSenor2 <- calculate_distances(Senor2)\nSeth2 <- calculate_distances(Seth2)\nShadow2 <- calculate_distances(Shadow2)\nShakespeare2 <- calculate_distances(Shakespeare2)\nSheldon <- calculate_distances(Sheldon)\nSmattie <- calculate_distances(Smattie)\nSmokey2 <- calculate_distances(Smokey2)\nSnickerdoodle2 <- calculate_distances(Snickerdoodle2)\nSolo2 <- calculate_distances(Solo2)\nSparkles <- calculate_distances(Sparkles)\nSpencer2 <- calculate_distances(Spencer2)\nSpike <- calculate_distances(Spike)\nStarbuck2 <- calculate_distances(Starbuck2)\nStriper2 <- calculate_distances(Striper2)\nSunny2 <- calculate_distances(Sunny2)\nSurvivor2 <- calculate_distances(Survivor2)\nSweetpea <- calculate_distances(Sweetpea)\nSylvester <- calculate_distances(Sylvester)\nTabasco <- calculate_distances(Tabasco)\nTallulah2 <- calculate_distances(Tallulah2)\nTara2 <- calculate_distances(Tara2)\nTex2 <- calculate_distances(Tex2)\nTiger2 <- calculate_distances(Tiger2)\nTonka2 <- calculate_distances(Tonka2)\nTurtle2 <- calculate_distances(Turtle2)\nVioletMae2 <- calculate_distances(VioletMae2)\nWilly2 <- calculate_distances(Willy2)\nZelda2 <- calculate_distances(Zelda2)\nZiggy <- calculate_distances(Ziggy)\nZoey <- calculate_distances(Zoey)\nZorro2 <- calculate_distances(Zorro2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Joining all datasets together\nadjusted_cat_distance <- full_join(Ajax2, Anubis) %>%\n                    full_join(Asher2) %>%\n                    full_join(Asibo2) %>%\n                    full_join(Atticus) %>%\n                    full_join(Aya2) %>%\n                    full_join(BabyKitty) %>%\n                    full_join(Bean2) %>%\n                    full_join(Beatle2) %>%\n                    full_join(Bela2) %>%\n                    full_join(Bella2) %>%\n                    full_join(Beluga) %>%\n                    full_join(Benny) %>%\n                    full_join(BillyWhiskers) %>%\n                    full_join(Bongo2) %>%\n                    full_join(BooBooKitty) %>%\n                    full_join(Bumbles2) %>%\n                    full_join(CaptainAmerica) %>%\n                    full_join(CatMarshall) %>%\n                    full_join(CatnissEverdeen) %>%\n                    full_join(Cayden2) %>%\n                    full_join(Cedar2) %>%\n                    full_join(Chester2) %>%\n                    full_join(Climber2) %>%\n                    full_join(Coal) %>%\n                    full_join(Conan) %>%\n                    full_join(Diamond2) %>%\n                    full_join(DonCarlos) %>%\n                    full_join(DonaldFluffypants) %>%\n                    full_join(Douglas) %>%\n                    full_join(Elle) %>%\n                    full_join(Emmy2) %>%\n                    full_join(FenimoreCooper) %>%\n                    full_join(Fiona2) %>%\n                    full_join(Fletcher2) %>%\n                    full_join(Frank) %>%\n                    full_join(Franklin) %>%\n                    full_join(George2) %>%\n                    full_join(Gianni2) %>%\n                    full_join(Goliath2) %>%\n                    full_join(Gracie) %>%\n                    full_join(GracieL2) %>%\n                    full_join(Hailey2) %>%\n                    full_join(Harley2) %>%\n                    full_join(Hemingway) %>%\n                    full_join(Herman2) %>%\n                    full_join(Hershey) %>%\n                    full_join(Jack2) %>%\n                    full_join(Jams2) %>%\n                    full_join(Jello2) %>%\n                    full_join(Jetpack) %>%\n                    full_join(Jingles2) %>%\n                    full_join(Jitterbug2) %>%\n                    full_join(Joey) %>%\n                    full_join(Junior2) %>%\n                    full_join(Justice) %>%\n                    full_join(Kagin2) %>%\n                    full_join(KatnissEverdeen) %>%\n                    full_join(Lacey) %>%\n                    full_join(Ladybird2) %>%\n                    full_join(Leopard2) %>%\n                    full_join(Lester) %>%\n                    full_join(Little2) %>%\n                    full_join(LouieTag) %>%\n                    full_join(Lucky2) %>%\n                    full_join(Luna2) %>%\n                    full_join(Lupe2) %>%\n                    full_join(Maddie2) %>%\n                    full_join(Maisey2) %>%\n                    full_join(Marco2) %>%\n                    full_join(MarthaWayne2) %>%\n                    full_join(Merrie2) %>%\n                    full_join(Mia2) %>%\n                    full_join(Milo) %>%\n                    full_join(Mindy2) %>%\n                    full_join(MinnieH) %>%\n                    full_join(Misty) %>%\n                    full_join(Misu2) %>%\n                    full_join(Motorcat) %>%\n                    full_join(MrLucky) %>%\n                    full_join(Natasha2) %>%\n                    full_join(NattyBumpo2) %>%\n                    full_join(Nia) %>%\n                    full_join(Nikki2) %>%\n                    full_join(Nola2Tag) %>%\n                    full_join(Oatmeal) %>%\n                    full_join(Oliver2) %>%\n                    full_join(Orange) %>%\n                    full_join(Oreo2) %>%\n                    full_join(OscarJ) %>%\n                    full_join(OscarL) %>%\n                    full_join(OscarN) %>%\n                    full_join(Parker) %>%\n                    full_join(Peanut) %>%\n                    full_join(PeanutR) %>%\n                    full_join(Penelope2) %>%\n                    full_join(Picchu) %>%\n                    full_join(Pickles2) %>%\n                    full_join(Piper2) %>%\n                    full_join(Poly) %>%\n                    full_join(Pringle) %>%\n                    full_join(PsychoKitty) %>%\n                    full_join(PumpkinKane) %>%\n                    full_join(Pumpkin2) %>%\n                    full_join(Purrcy2) %>%\n                    full_join(Reggie2) %>%\n                    full_join(Roukus2) %>%\n                    full_join(Russel2) %>%\n                    full_join(Sandstorm2) %>%\n                    full_join(Sasquatch2) %>%\n                    full_join(Schubie2) %>%\n                    full_join(Selkie2) %>%\n                    full_join(Senor2) %>%\n                    full_join(Seth2) %>%\n                    full_join(Shadow2) %>%\n                    full_join(Shakespeare2) %>%\n                    full_join(Sheldon) %>%\n                    full_join(Smattie) %>%\n                    full_join(Smokey2) %>%\n                    full_join(Snickerdoodle2) %>%\n                    full_join(Solo2) %>%\n                    full_join(Sparkles) %>%\n                    full_join(Spencer2) %>%\n                    full_join(Spike) %>%\n                    full_join(Starbuck2) %>%\n                    full_join(Sunny2) %>%\n                    full_join(Survivor2) %>%\n                    full_join(Sweetpea) %>%\n                    full_join(Sylvester) %>%\n                    full_join(Tabasco) %>%\n                    full_join(Tallulah2) %>%\n                    full_join(Tara2) %>%\n                    full_join(Tex2) %>%\n                    full_join(Tiger2) %>%\n                    full_join(Tonka2) %>%\n                    full_join(Turtle2) %>%\n                    full_join(VioletMae2) %>%\n                    full_join(Willy2) %>%\n                    full_join(Zelda2) %>%\n                    full_join(Zoey) %>%\n                    full_join(Zorro2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#convert distance from Km to m\nadjusted_cat_distance <- adjusted_cat_distance %>%\n  mutate(distance = distance*1000)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Disable scientific notation\noptions(scipen = 999)\n#Creating variables for average distances per 3 minute cycle and per day\nsummaries_by_day <- adjusted_cat_distance %>%\n  filter(distance <= 1000) %>%\n  group_by(`individual-local-identifier`, Date) %>%\n  summarize(mean_distance = mean(distance, \n                                 na.rm = TRUE),\n            sum_distance = sum(distance, \n                               na.rm = TRUE))\n\n#Creating variables for averages for each cat\nsummaries_by_cat <- summaries_by_day %>%\n  group_by(`individual-local-identifier`) %>%\n  summarize(mean_distance_obs = mean(mean_distance),\n            avg_distance_day = mean(sum_distance)) \n\ncat_reference <- cat_reference %>%\n  filter(!is.na(`animal-life-stage`)) %>%\n  filter(`animal-id` != \"Banjo2\") %>%\n  filter(`animal-id` != \"Boris2\") %>%\n  filter(`animal-id` != \"Rocky\") %>%\n  filter(`animal-id` != \"Striper2\") %>%\n  filter(`animal-id` != \"Ziggy\") \n\n#Binding the reference cat dataset with their average distances per cycle and per day, removing any cat with no age listed\nmerged_summaries_by_cat <- cbind(summaries_by_cat, \n                                 cat_reference) \n\n#Tidying up the life stage variable by removing \"years\" in each observations\nmerged_summaries_by_cat$`animal-life-stage` <- gsub(\" years\", \n                                                    \"\", \n                                                    merged_summaries_by_cat$`animal-life-stage`)\nmerged_summaries_by_cat$`animal-life-stage` <- gsub(\" year\", \n                                                    \"\", \n                                                    merged_summaries_by_cat$`animal-life-stage`)\n\n#Tidying up the animal comments variable by separating it into two variables for hunting and prey per month\nmerged_summaries_by_cat <- cbind(merged_summaries_by_cat, \n                                 do.call(rbind, \n                                         strsplit(merged_summaries_by_cat$`animal-comments`, \n                                                  \"; \", \n                                                  fixed = TRUE)))\nmerged_summaries_by_cat <- merged_summaries_by_cat %>%\n  subset(select = -`3`) %>%\n  rename(`Hunt` = `1`,\n         `prey_p_month` = `2`)\nmerged_summaries_by_cat$hunt <- ifelse(grepl(\"Yes\", \n                                             merged_summaries_by_cat$Hunt), \n                                       TRUE, FALSE)\nmerged_summaries_by_cat$prey_p_month <- as.numeric(gsub(\"prey_p_month: \", \n                                                        \"\", \n                                                        merged_summaries_by_cat$prey_p_month))\n\n#Tidying up the manipulation comments variable by separating it into two variables for hours spent indoors and number of cats in the household \nmerged_summaries_by_cat <- cbind(merged_summaries_by_cat, do.call(rbind, strsplit(trimws(merged_summaries_by_cat$`manipulation-comments`), \";\", fixed = TRUE)))\nmerged_summaries_by_cat <- merged_summaries_by_cat %>%\n  subset(select = -`3`) %>%\n  rename(`hrs_indoors` = `1`,\n         `n_cats_household` = `2`)\nmerged_summaries_by_cat$hrs_indoors <- as.numeric(gsub(\"hrs_indoors: \", \n                                                       \"\", \n                                                       merged_summaries_by_cat$hrs_indoors))\nmerged_summaries_by_cat$n_cats_household <- as.numeric(gsub(\"n_cats: \", \n                                                            \"\", \n                                                            merged_summaries_by_cat$n_cats_household))\nmerged_summaries_by_cat <- merged_summaries_by_cat %>%\n  mutate(`animal-life-stage` = as.numeric(`animal-life-stage`))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Getting rid of unnecessary variables and observations outside the United States\nmerged_summaries_by_cat <- merged_summaries_by_cat %>%\n  subset(select = -`animal-comments`) %>%\n  subset(select = -`manipulation-comments`) %>%\n  subset(select = -`Hunt`) %>%\n  subset(select = -`animal-taxon`) %>%\n  subset(select = -`attachment-type`) %>%\n  subset(select = -`data-processing-software`) %>%\n  subset(select = -`deployment-end-type`) %>%\n  subset(select = -`duty-cycle`) %>%\n  subset(select = -`manipulation-type`) %>%\n  subset(select = -`tag-manufacturer-name`) %>%\n  subset(select = -`tag-mass`) %>%\n  subset(select = -`tag-model`) %>%\n  subset(select = -`tag-readout-method`) %>%\n  filter(`study-site` != \"Denmark\" & `study-site` != \"Newfoundland\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter data for the cat named Sparkles on a specific date\nsparkles_cat <- adjusted_cat_distance %>%\n  filter(`individual-local-identifier` == \"Sparkles\") %>%\n  filter(Date == \"2016-03-29\") %>%\n  mutate(Time = hms(Time))  # Convert time to hms format\n\n# Ensure data is sorted by time\nsparkles_cat <- sparkles_cat[order(sparkles_cat$Time), ]\n\n# Create the base ggplot object\nggplot(sparkles_cat, aes(x = `location-long`, y = `location-lat`, group = 1)) +\n  geom_path() + \n  geom_point() + \n  labs(x = \"Longitude\", y = \"Latitude\", title = \"Location Changes Over Time\")\n```\n\n::: {.cell-output-display}\n![](practicecode_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Function\nplot_cat_movement <- function(adjusted_cat_distance, cat_identifier, date) {\n  \n  motorcat_cat <- adjusted_cat_distance %>%\n    filter(`individual-local-identifier` == cat_identifier) %>%\n    filter(Date == date) %>%\n    mutate(Time = as.POSIXct(Time, format = \"%H:%M:%S\", tz = \"UTC\")) %>%  # Convert to POSIXct\n    arrange(Time)\n  \n  # Generate title dynamically\ntitle <- paste(\"Location Changes Over Time for\", cat_identifier, \"on\", date)\n  \nggplot(motorcat_cat, aes(x = `location-long`, y = `location-lat`, group = 1, color = Time)) +\n  geom_path() + \n  geom_point() +\n  labs(x = \"Longitude\", y = \"Latitude\", title = title) +\n  scale_color_datetime(\n      name = \"Time\",\n      labels = date_format(\"%H:%M:%S\"),  # Format labels as HH:MM:SS\n      breaks = date_breaks(\"2 hours\"),   # Specify breaks for the time scale\n      limits = range(motorcat_cat$Time) # Set limits based on the range of Time\n    ) \n}\n\n\n\n# Usage example\nplot_cat_movement(adjusted_cat_distance, \"Motorcat\", \"2013-08-14\")\n```\n\n::: {.cell-output-display}\n![](practicecode_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_cat_movement(adjusted_cat_distance, \"Zoey\", \"2015-01-07\")\n```\n\n::: {.cell-output-display}\n![](practicecode_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_cat_movement(adjusted_cat_distance, \"Franklin\", \"2015-02-25\")\n```\n\n::: {.cell-output-display}\n![](practicecode_files/figure-html/unnamed-chunk-12-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nage_summaries <- merged_summaries_by_cat %>%\n  group_by(`animal-life-stage`) %>%\n  summarize(avg_dist_day_by_age = mean(avg_distance_day),\n            avg_dist_obs_by_age = mean(mean_distance_obs))\nggplot(age_summaries, aes(x = `animal-life-stage`, y = avg_dist_day_by_age)) +\n  geom_col(color = \"#45105b\", fill = \"#9a94bc\") +\n  labs(x = \"Age in Years\", y = \"Average Distance in m\", title = \"Average Distance Traveled By Cats Each Day, \\nGrouped by Age\")\n```\n\n::: {.cell-output-display}\n![](practicecode_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(age_summaries, aes(x = `animal-life-stage`, y = avg_dist_obs_by_age)) +\n  geom_col(color = \"#45105b\", fill = \"#9a94bc\") +\n  labs(x = \"Age in Years\", y = \"Average Distance in m\", title = \"Average Distance Traveled By Cats per 3-Min Cycle, \\nGrouped by Age\")\n```\n\n::: {.cell-output-display}\n![](practicecode_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n:::",
    "supporting": [
      "practicecode_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}